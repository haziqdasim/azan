<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>AZAN</title>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
            rel="stylesheet">
        <link
            href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&family=Roboto:wght@300;500&display=swap"
            rel="stylesheet">
        <style>
        body {
            background-color: white;
            color: black;
            font-family: 'Poppins', sans-serif;
            overflow-x: hidden;
        }

        /* .digital-clock {
            font-family: 'Poppins', sans-serif;
            font-weight: bold;
            font-size: 5rem;
            color: #00d4ff;
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
        } */

        /* .prayer-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            transition: transform 0.3s;
        } */

        .active-prayer {
            border: 2px solid #00d4ff;
            background: rgba(0, 212, 255, 0.1);
            transform: scale(1.05);
        }

        /* .prayer-time {
            font-size: 2rem;
            font-weight: bold;
        } */

        /* .label {
            color: #aaa;
            text-transform: uppercase;
            font-size: 0.8rem;
        } */
    </style>
    </head>

    <body>
        <div class="container-fluid vh-100 d-flex flex-column p-4">
            <div class="row">
                    <div class="col-md-12">
                        <div class="text-center">
                            <h1>Masjid Abu Bakar Tanah Rata Cameron
                                Highlands</h1>
                            <h6>Pusat ibadah dan komuniti masyarakat.</h6>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="text-center">
                            <button type="button" class="btn btn-primary">Info
                                Terkini</button>
                            <button type="button" class="btn btn-outline-secondary">Infak
                                Masjid</button>
                        </div>

                    </div>
                </div>
                <div class="row">
                    <div class="col-md-2">
                        <div class="card prayer-card p-4 text-center"
                            id="card-fajr">
                            <div class="card-body">
                                <div class="label">Subuh</div>
                                <div class="prayer-time"
                                    id="time-fajr">--:--</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="card prayer-card p-4 text-center"
                            id="card-syuruk">
                            <div class="card-body">
                                <div class="label">Syuruk</div>
                                <div class="prayer-time"
                                    id="time-syuruk">--:--</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="card prayer-card p-4 text-center"
                            id="card-dhuhr">
                            <div class="card-body">
                                <div class="label">Zohor</div>
                                <div class="prayer-time"
                                    id="time-dhuhr">--:--</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="card prayer-card p-4 text-center"
                            id="card-asr">
                            <div class="card-body">
                                <div class="label">Asar</div>
                                <div class="prayer-time"
                                    id="time-asr">--:--</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="card prayer-card p-4 text-center"
                            id="card-maghrib">
                            <div class="card-body">
                                <div class="label">Maghrib</div>
                                <div class="prayer-time"
                                    id="time-maghrib">--:--</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2">
                        <div class="card prayer-card p-4 text-center"
                            id="card-isha">
                            <div class="card-body">
                                <div class="label">Isyak</div>
                                <div class="prayer-time"
                                    id="time-isha">--:--</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <span class="badge text-bg-success">
                            <span id="liveClock">00:00:00</span>
                            <span id="hijriDate">-- --- ----</span>
                            <span>Hijrah</span>
                            <span id="masihiDate">-- --- ----</span>
                        </span>
                        <button class="btn btn-primary btn-sm"
                            data-bs-toggle="modal"
                            data-bs-target="#settingsModal">Pilih Zon</button>
                        <div id="currentZone" class="badge bg-secondary">Zon:
                        </div>
                    </div>
                </div>

        </div>

        <!-- <div class="container-fluid vh-100 d-flex flex-column p-4">
            <div class="row mb-4">
                <div class="col-md-4">
                    <h4 id="masihiDate">-- --- ----</h4>
                    <h5>
                        <span class="text-info" id="hijriDate">-- ---
                            ----</span>
                        <span class="text-info">Hijrah</span>
                    </h5>

                </div>
                <div class="col-md-4 text-center">
                    <div class="digital-clock" id="liveClock">00:00:00</div>
                    <div id="currentZone" class="badge bg-secondary">Zon: </div>
                </div>
                <div class="col-md-4 text-end">
                    <button class="btn btn-outline-light btn-sm"
                        data-bs-toggle="modal"
                        data-bs-target="#settingsModal">Pilih Zon</button>
                </div>
            </div>

            <div class="row g-3 flex-grow-1 align-items-center">
                <div class="col">
                    <div class="prayer-card p-4 text-center" id="card-fajr">
                        <div class="label">Subuh</div>
                        <div class="prayer-time" id="time-fajr">--:--</div>
                    </div>
                </div>
                <div class="col">
                    <div class="prayer-card p-4 text-center" id="card-syuruk">
                        <div class="label">Syuruk</div>
                        <div class="prayer-time" id="time-syuruk">--:--</div>
                    </div>
                </div>
                <div class="col">
                    <div class="prayer-card p-4 text-center" id="card-dhuhr">
                        <div class="label">Zohor</div>
                        <div class="prayer-time" id="time-dhuhr">--:--</div>
                    </div>
                </div>
                <div class="col">
                    <div class="prayer-card p-4 text-center" id="card-asr">
                        <div class="label">Asar</div>
                        <div class="prayer-time" id="time-asr">--:--</div>
                    </div>
                </div>
                <div class="col">
                    <div class="prayer-card p-4 text-center" id="card-maghrib">
                        <div class="label">Maghrib</div>
                        <div class="prayer-time" id="time-maghrib">--:--</div>
                    </div>
                </div>
                <div class="col">
                    <div class="prayer-card p-4 text-center" id="card-isha">
                        <div class="label">Isyak</div>
                        <div class="prayer-time" id="time-isha">--:--</div>
                    </div>
                </div>
            </div>
        </div> -->

        <div class="modal fade" id="settingsModal" tabindex="-1"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Ubah Zon</h5>
                        <button type="button" class="btn-close"
                            data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <label class="form-label">Pilih Zon</label>
                        <select class="form-select" id="zoneSelect">
                            <option value="SGR01" selected>Selangor (Gombak,
                                Petaling, Sepang, Hulu Langat, Hulu Selangor,
                                S.Alam)</option>
                            <option value="SGR02">Selangor (Kuala Selangor,
                                Sabak Bernam)</option>
                            <option value="SGR03">Selangor (Klang, Kuala
                                Langat)</option>

                            <option value="JHR01">Johor (Pulau Aur dan Pulau
                                Pemanggil)</option>
                            <option value="JHR02">Johor (Johor Bahru, Kota
                                Tinggi, Mersing)</option>
                            <option value="JHR03">Johor (Kluang,
                                Pontian)</option>
                            <option value="JHR04">Johor (Batu Pahat, Muar,
                                Segamat, Gemas Johor)</option>

                            <option value="MLK01">Seluruh Negeri Melaka</option>

                        </select>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary"
                            onclick="saveSettings()">Simpan</button>
                    </div>
                </div>
            </div>
        </div>

        <script>
        // 1. Mapping for Hijrah Months
        const hijriMonths = [
            "Muharam", "Safar", "Rabiul Awal", "Rabiul Akhir",
            "Jamadil Awal", "Jamadil Akhir", "Rejab", "Sya'ban",
            "Ramadan", "Syawal", "Zulkaedah", "Zulhijjah"
        ];

        // 2. Mapping for Zone Names (Partial list - add more as needed)
        const zoneNames = {
            "SGR01": "Gombak, Petaling, Sepang, Hulu Langat, S.Alam",
            "SGR02": "Kuala Selangor, Sabak Bernam",
            "SGR03": "Klang, Kuala Langat",
            "JHR01": "Pulau Aur dan Pulau Pemanggil",
            "JHR02": "Johor Bahru, Kota Tinggi, Mersing",
            "MLK01": "Seluruh Negeri Melaka",
            "WLY01": "Kuala Lumpur, Putrajaya"
        };

        let currentZone = localStorage.getItem('azanZone') || 'SGR01';

        function updateClock() {
            const now = new Date();
            document.getElementById('liveClock').innerText = now.toLocaleTimeString('en-GB');
            document.getElementById('masihiDate').innerText = now.toLocaleDateString('en-MY', {
                weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'
            });
        }

        async function fetchPrayerTimes() {
            try {
                const response = await fetch(`https://www.e-solat.gov.my/index.php?r=esolatApi/takwimsolat&zone=${currentZone}&period=today`);
                const result = await response.json();

                if (result.status === "OK!" && result.prayerTime.length > 0) {
                    const todayData = result.prayerTime[0];

                    // --- FORMAT HIJRAH DATE ---
                    // Input format: "1447-08-17"
                    const hijriParts = todayData.hijri.split('-');
                    const year = hijriParts[0];
                    const monthIdx = parseInt(hijriParts[1]) - 1; // Convert "08" to index 7
                    const day = hijriParts[2];
                    const hijriFullDate = `${day} ${hijriMonths[monthIdx]} ${year}`;
                    document.getElementById('hijriDate').innerText = hijriFullDate;

                    // --- DISPLAY ZONE NAME ---
                    const zoneName = zoneNames[currentZone] || currentZone;
                    document.getElementById('currentZone').innerText = `Zon: ${zoneName}`;

                    // --- UPDATE PRAYER TIMES ---
                    const prayerMapping = {
                        'fajr': todayData.fajr,
                        'syuruk': todayData.syuruk,
                        'dhuhr': todayData.dhuhr,
                        'asr': todayData.asr,
                        'maghrib': todayData.maghrib,
                        'isha': todayData.isha
                    };

                    for (const [id, timeStr] of Object.entries(prayerMapping)) {
                        const [h, m] = timeStr.split(':');
                        const t = new Date();
                        t.setHours(h, m, 0);

                        document.getElementById(`time-${id}`).innerText = t.toLocaleTimeString('en-GB', {
                            hour: '2-digit', minute: '2-digit', hour12: true
                        }).toUpperCase();
                    }
                }
            } catch (error) {
                console.error("Fetch error:", error);
            }
        }

        function saveSettings() {
            currentZone = document.getElementById('zoneSelect').value;
            localStorage.setItem('azanZone', currentZone);
            fetchPrayerTimes();
            bootstrap.Modal.getInstance(document.getElementById('settingsModal')).hide();
        }

        setInterval(updateClock, 1000);
        updateClock();
        fetchPrayerTimes();
    </script>

        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    </body>

</html>